!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hera=t():e.Hera=t()}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";function r(e,t){return JSON.stringify(e)===JSON.stringify(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.parse=t.Parser=t.error=t.ok=t.Reply=t.State=void 0;class s{constructor(e,t=0,n){this.source=e,this.position=t,this._userState=n}seek(e){return new s(this.source,this.position+e,this._userState)}getRowColumn(){const e=this.source.split("\n");let t=0,n=0;for(;t<this.position&&!(this.position<=t+e[n].length);)t+=e[n].length+1,n++;return{raw:n,column:this.position-t}}rest(){return this.source.slice(this.position)}equals(e){return e&&this.source===e.source&&this.position===e.position&&r(this._userState,e._userState)}toString(){return`\n\t\t\tState: {\n\t\t\t\tsource: ${this.source.length<=100?`"${this.source}"`:`"${this.source.slice(0,100)}"...`}\n\t\t\t\tposition: ${this.position}\n\t\t\t\tuserState: ${JSON.stringify(this._userState)}\n\t\t\t}\n\t\t`}}t.State=s;class o{constructor(e,t,n,r){this.state=e,this.success=t,this.value=n,this.expected=r}toString(){return`\n\t\t\tReply { \n\t\t\t\tsuccess: ${this.success}\n\t\t\t\t${this.success?"value: "+String.raw`${this.value}`:"expected: "+this.expected()}\n\t\t\t\tstate: ${this.state.toString().replace(/^(?!\s*$)/gm,"\t\t")}\n\t\t\t}\n\t\t`}equals(e){return e&&this.state.equals(e.state)&&this.success===e.success&&(this.success?r(this.value,e.value):void 0===this.expected&&void 0===e.expected||this.expected()===e.expected())}}t.Reply=o,t.ok=function(e,t){return new o(e,!0,t)},t.error=function(e,t){return new o(e,!1,void 0,t)};t.Parser=class{constructor(e){this.runParser=e}toString(){return this.runParser.toString()}},t.parse=function(e,t){return e.runParser(t)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.compile=t.Op=void 0;const u=o(n(2)),c=i(n(3)),a=u.oneOf("_$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),f=u.oneOf("_$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"),p=u.oneOf("+-*/=!$%&^~@?_><:|\\."),l=u.oneOf("+-*/=!$%&^~@?_><:|\\."),d=u.buildTokenParser({multiCommentStart:u.string("/*"),multiCommentEnd:u.string("*/"),singleCommentLine:u.string("//"),identifierStart:a,identifierLetter:f,opStart:p,opLetter:l,reservedNames:["function","return","op","infix","infixl","infixr","prefix","postfix","val","var","if","else","for","native","->"],reservedOps:[],caseSensitive:!0});class h{constructor(){this.operators=[],this.binaryOps={},this.unaryOps={},this.operators[0]=new u.OperatorTable}}t.Op=h;class m{constructor(e=[]){this.stack=e}push(e){this.stack.push(e)}pop(){return this.stack.pop()}get head(){return this.stack[0]}get last(){return this.stack[this.stack.length-1]}get length(){return this.stack.length}peek(e){return this.stack[e]}}class g{constructor(){this.stack=new m,this.currentCursor=-1,this.argsTable=this.stack.peek(0)}advance(e=1){const t=this.currentCursor+e;if(t+1>this.stack.length)for(let e=0;e<t+1-this.stack.length;e++)this.stack.push(new Map);this.argsTable=this.stack.peek(t),this.currentCursor=t}back(e){const t=this.currentCursor-e;t>=0&&(this.argsTable=this.stack.peek(t),this.currentCursor=t)}getArgsCount(e){return this.stack.peek(this.currentCursor+1).get(e)}addArgsCount(e,t){this.argsTable.set(e,t)}}t.compile=function(e){const t=new c.default,n=new h;let r;n.operators[0].infix.push(d.lexeme(u.seq(e=>{e(u.string("`"));const t=e(a),n=e(u.many(f));return e(u.string("`")),(e,r)=>`(${t}${n.join("")}(${e}, ${r}))`}))),n.operators[0].infixr.push(d.lexeme(u.seq(e=>(e(u.string(".")),(e,n)=>{const r=t.transaction();return r.append("(function() {\n"),r.indent(),r.queue(`return ${e}(${n}.apply(undefined, arguments));\n`),r.dedent(),r.queue("})"),r.get()}))));const s=u.lazy(()=>{if(!r){const e=n.operators.filter(Boolean);r=u.buildExpressionParser(e,i)}return r});function o(e){let t=0;const n=u.many(u.seq(n=>{n(u.notFollowedBy(d.semi)),n(u.optional(d.stringLiteral)),n(u.optional(d.charLiteral));const r=n.state.position,s=n(u.optional(d.identifier));if(s){if(e.indexOf(s)>-1)return{name:s,cursor:[r-t,r-t+s.length]};n(u.unexpected("identifier "+s))}else n(u.notFollowedBy(d.semi)),n(u.anyChar)}));return u.seq(e=>{t=e.state.position;const r=u.parse(u.until(d.semi),new u.State(e.state.source.slice(e.state.position)));if(!r.success||!r.value)return void e(u.fail("parsing error in nativeExpressionParser"));const s=r.value,o=e(n).filter(Boolean);return function(e){let t=s,n=0;for(let r=0;r<o.length;r++){const s=o[r],i=e[s.name];if(i){const e=t.slice(0,s.cursor[0]+n),r=t.slice(s.cursor[1]+n,t.length);t=e+i+r,n+=i.length-(s.cursor[1]-s.cursor[0])}}return t}})}const i=u.label("term",u.seq(e=>{const r=t.transaction(),o=u.or(u.fmap(e=>[e],d.identifier),d.parens(u.sepBy(d.identifier,d.comma))),i=u.or(d.braces(u.seq(e=>{r.indent();const t=e(u.many(w));return r.dedent(),t})),u.fmap(e=>{t.indent();const n=[t.get("return "),e,";","\n"];return t.dedent(),n},s)),c=u.seq(e=>{const t=e(o);e(d.symbol("=>"));const n=e(i);if(e.success)return r.queue(`((${t.join(", ")}) => `),r.append("{\n"),n.forEach(e=>{r.queue(e)}),r.queue("})"),r.get()}),a=u.seq(e=>(e(d.reserved("native")),t.get(e(d.stringLiteral)))),f=u.fmap(e=>{const r=t.transaction();if(n.binaryOps[e])return r.append("(function(x, y) {\n"),r.indent(),r.queue(`return ${n.binaryOps[e]("x","y")};`),r.dedent(),r.append("\n})"),r.get();if(n.unaryOps[e])return r.append("(function(x) {\n"),r.indent(),r.queue(`return ${n.unaryOps[e]("x")};`),r.dedent(),r.append("\n})"),r.get();throw new Error("Unknown operator: "+e)},d.parens(d.operator)),p=u.fmap(e=>`[${e.join(", ")}]`,d.brackets(u.sepBy(s,d.comma))),l=u.seq(e=>{e(d.symbol("("));const r=e(d.operator),s=e(m);if(e(d.symbol(")")),n.binaryOps[r]){const e=t.transaction();return e.queue("(function(x) {\n"),e.indent(),e.queue("return "+n.binaryOps[r]("x",s)),e.dedent(),e.queue("\n})"),e.get()}}),h=u.seq(e=>{e(d.symbol("("));const r=e(m),s=e(d.operator);if(e(d.symbol(")")),n.binaryOps[s]){const e=t.transaction();return e.queue("(function(x) {\n"),e.indent(),e.queue("return "+n.binaryOps[s]("x",r)),e.dedent(),e.queue("\n})"),e.get()}}),m=u.or(u.triable(f),u.triable(c),p,u.triable(l),u.triable(h),u.fmap(e=>`(${e})`,d.parens(s)),u.fmap(e=>`"${e}"`,d.stringLiteral),u.fmap(e=>e.toString(),d.naturalOrFloat),a,d.identifier),g=e(m),y=u.fmap(n=>{const r=e._userState.scope.getArgsCount(g);if(n.length<r&&(n=n.concat(Array(r-n.length).fill(void 0))),n.every(e=>!!e))return`${g}(${n.join(", ")})`;{const e=[],r=[];for(let t=0;t<n.length;t++)if(void 0===n[t]){const n=String.fromCharCode(97+t).toString();r.push(n),e.push(n)}else e.push(n[t]);const s=t.transaction();return s.append("(function(f) {\n"),s.indent(),s.queue(`return function(${r.join(", ")}) {\n`),s.indent(),s.queue(`return f(${e.join(", ")})\n`),s.dedent(),s.queue("}\n"),s.dedent(),s.queue("}"),s.append(`(${g}))`),s.get()}},d.parens(u.sepBy(u.option(s,void 0),d.comma)));return e(u.option(y,g))})),p=u.seq(e=>{const t=e(u.choice(["infixl","infixr","infix","prefix","postfix"].map(d.reserved))),r=e(d.natural),s=e(d.operator);function i(e,o){n.operators[r]=n.operators[r]||new u.OperatorTable;const i=n.operators[r];"infixl"===t?(i.infixl.push(u.fmap(e=>o,d.reservedOp(s))),n.binaryOps[s]=o):"infixr"===t?(i.infixr.push(u.fmap(e=>o,d.reservedOp(s))),n.binaryOps[s]=o):"infix"===t?(i.infix.push(u.fmap(e=>o,d.reservedOp(s))),n.binaryOps[s]=o):"prefix"===t?(i.prefix.push(u.fmap(t=>e,d.reservedOp(s))),n.unaryOps[s]=e):"postfix"===t&&(i.postfix.push(u.fmap(t=>e,d.reservedOp(s))),n.unaryOps[s]=e)}e(d.reserved("->"));const c=u.seq(e=>{const t=e(d.identifier);e(u.lookAhead(d.semi)),e.success&&i(e=>`${t}(${e})`,(e,n)=>`${t}(${e}, ${n})`)});switch(t){case"infixl":case"infxr":case"infix":e(u.or(c,u.seq(e=>{const t=e(d.identifier);e(d.symbol(s));const n=e(d.identifier);e(d.symbol("=>"));const r=e(o([t,n]));e.success&&i(e=>r({[t]:e}),(e,s)=>r({[t]:e,[n]:s}))})));break;case"prefix":e(u.or(c,u.seq(e=>{e(d.symbol(s));const t=e(d.identifier);e(d.symbol("=>"));const n=e(o([t]));e.success&&i(e=>n({[t]:e}))})));break;case"postfix":e(u.or(c,u.seq(e=>{const t=e(d.identifier);e(d.symbol(s)),e(d.symbol("=>"));const n=e(o([t]));e.success&&i(e=>n({[t]:e}))})))}return e(d.semi),""}),l=k(u.seq(e=>{const n=t.transaction();e(d.reserved("function"));const r=e(d.identifier),s=e(d.parens(u.sepBy(d.identifier,d.comma)));e.success&&(e._userState.scope.addArgsCount(r,s.length),n.queue(`function ${r}(${s.join(", ")}) {\n`),n.indent());const o=e(d.braces(u.many(w)));if(e.success)return o.forEach(e=>{n.append(e)}),n.dedent(),n.queue("}\n"),n.get()})),m=u.fmap(e=>e+";\n",u.head(s,d.semi)),y=u.seq(e=>{const t=e(u.or(d.reserved("val"),d.reserved("var"))),n=e(d.identifier);e(d.symbol("="));return`${"val"===t?"const":"var"} ${n} = ${e(s)}`}),b=u.seq(e=>{const n=e(y);return e(d.semi),t.get(n+";\n")}),x=u.seq(e=>{e(d.reserved("if"));const n=e(d.parens(s)),r=e(_),o=e(u.option(u.seq(e=>(e(d.reserved("else"))," else "+e(u.or(_,x)))),""));return t.get(`if(${n}) `+r+o+"\n")}),v=u.seq(e=>{e(d.reserved("for"));const n=e(d.parens(u.seq(e=>{const t=e(u.option(u.or(y,s),""));e(d.semi);const n=e(s);e(d.semi);return`(${t}; ${n}; ${e(s)}) `}))),r=e(_);return t.get("for"+n+r+"\n")}),O=u.fmap(e=>t.get(`return ${e};\n`),u.between(d.reserved("return"),s,d.semi));function k(e){return u.seq(t=>{t._userState.scope.advance(1);const n=t(e);return t._userState.scope.back(1),n})}const w=u.or(l,O,x,v,b,m),_=k(u.or(u.fmap(e=>{const n=t.transaction();return n.append("{\n"),n.append(e.join("")),n.queue("}"),n.get()},d.braces(u.seq(e=>{t.indent();const n=e(u.many(w));return t.dedent(),n}))),s)),S=u.or(p,l,x,v,b,m),q=k(u.between(d.whiteSpaceOrComment,u.fmap(e=>e.join(""),u.many(S)),u.eof));return u.parse(q,new u.State(e,0,{scope:new g}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.buildTokenParser=t.buildExpressionParser=t.OperatorTable=t.Postfix=t.Prefix=t.NoneAssoc=t.RightAssoc=t.LeftAssoc=t.Assoc=t.hexDigit=t.octDigit=t.digit=t.letter=t.alphaNum=t.lower=t.upper=t.tab=t.newLine=t.spaces=t.space=t.anyChar=t.string=t.range=t.regexp=t.charCode=t.char=t.noneOf=t.oneOf=t.Join=t.until=t.satisfy=t.label=t.lazy=t.notFollowedBy=t.lookAhead=t.skipMany1=t.skipMany=t.optional=t.option=t.pure=t.fmap=t.endBy=t.endBy1=t.endByN=t.sepBy=t.sepBy1=t.sepByN=t.between=t.seq=t.head=t.series=t.array=t.many1=t.many=t.count=t.repeat=t.or=t.choice=t.triable=t.unexpected=t.fail=t.eof=t.empty=void 0;const o=n(0);function i(e){return new o.Parser(t=>o.error(t,()=>"failed: "+e))}function u(e){return new o.Parser(t=>o.error(t,()=>"unexpected: "+e))}function c(e){return new o.Parser((function(t){const n=o.parse(e,t);return n.success?n:o.error(t,n.expected)}))}function a(e){return new o.Parser((function(t){const n=[];for(let r=0;r<e.length;r++){const s=o.parse(e[r],t);if(s.success)return s;n.push(s)}return o.error(t,()=>"one of "+n.map(e=>e.expected()).join(", "))}))}function f(...e){return a(e)}function p(e,t,n){return new o.Parser((function(r){const s=[];let i=o.ok(r,void 0);for(let r=0;r<t;r++){const t=o.parse(n,i.state);if(!t.success){if(i.state.position<t.state.position)return o.error(t.state,t.expected);if(r<e)return o.error(t.state,t.expected);break}i=t,s.push(i.value)}return o.ok(i.state,s)}))}function l(e){return p(0,Number.MAX_VALUE,e)}function d(e){return p(1,Number.MAX_VALUE,e)}function h(e){return new o.Parser((function(t){const n=[];let r=o.ok(t);for(let s=0;s<e.length;s++){if(r=o.parse(e[s],t),!r.success)return o.error(r.state,r.expected);n.push(r.value)}return o.ok(r.state,n)}))}function m(...e){return h(e)}function g(e,...t){return new o.Parser((function(n){let r=o.parse(e,n);const s=r.value;for(let e=0;e<t.length&&r.success;e++)r=o.parse(t[e],r.state);return r.success?o.ok(r.state,s):r}))}function y(e){return new o.Parser((function(t){let n=o.ok(t,void 0);const r=e=>{if(n.success)return n=o.parse(e,n.state),r.success=n.success,r.state=n.state,n.value};r.success=!0,r.state=n.state,r._userState=n.state._userState;const s=e(r);return n.state._userState=r._userState,n.success?o.ok(n.state,s):n}))}function b(e,t,n){return y(r=>{r(e);const s=r(t);return r(n),s})}function x(e,t,n,r){return new o.Parser((function(s){let i=o.ok(s);const u=[];let c=o.parse(n,i.state);if(c.success){i=c,u.push(c.value);for(let s=1;s<t;s++){const t=o.parse(r,i.state);if(t.success){if(i=o.parse(n,t.state),i.success){u.push(i.value);continue}}else if(u.length<e)return o.error(c.state,c.expected);break}}else if(u.length<e)return o.error(c.state,c.expected);return i.success?o.ok(i.state,u):o.error(i.state,i.expected)}))}function v(e,t){return x(1,Number.MAX_VALUE,e,t)}function O(e,t,n,r){return p(e,t,g(n,r))}function k(e,t){return new o.Parser((function(n){const r=o.parse(t,n);return r.success?o.ok(r.state,e(r.value)):o.error(r.state,r.expected)}))}function w(e){return k(()=>e,t.empty)}function _(e,t){return f(e,w(t))}function S(e){return k(e=>{},l(e))}function q(e){return y(t=>{t(e),t(S(e))})}function P(e){return new o.Parser((function(t){const n=o.parse(e,t);return n.success?o.error(t,()=>"not "+n.value):o.ok(t,void 0)}))}function $(e,t){return new o.Parser((function(n){const r=o.parse(t,n);return r.success||r.state.position!==n.position?r:o.error(n,()=>e)}))}function A(e){return new o.Parser((function(t){if(t.position<t.source.length){const n=t.source[t.position],r=t.source.charCodeAt(t.position);if(e(n,r))return o.ok(t.seek(1),n)}return o.error(t,()=>`one of "${function(){const t=[];for(let n=32;n<=126;n++){const r=String.fromCharCode(n);e(r,n)&&t.push(r)}return t}().join("")}"`)}))}function j(e){return new o.Parser((function(t){if(t.position<=t.source.length)for(let n=t.position;n<t.source.length;n++){if(o.parse(e,new o.State(t.source.slice(n))).success)return o.ok(t.seek(n-t.position),t.source.slice(t.position,n))}return o.error(t.seek(t.source.length-t.position),()=>"can not match until the end")}))}function C(e){return A((t,n)=>e.indexOf(t)>=0)}function L(e){return A(t=>t===e)}function B(e,t=!0){return e=t?e:e.toLowerCase(),new o.Parser((function(n){const r=n.source.slice(n.position,n.position+e.length);return e===(t?r:r.toLowerCase())?o.ok(n.seek(e.length),e):o.error(n,()=>'"'+e+'"')}))}s(n(0),t),t.empty=new o.Parser(e=>o.ok(e,void 0)),t.eof=new o.Parser(e=>e.position===e.source.length?o.ok(e.seek(1),void 0):o.error(e,()=>"end of file")),t.fail=i,t.unexpected=u,t.triable=c,t.choice=a,t.or=f,t.repeat=p,t.count=function(e,t){return p(e,e,t)},t.many=l,t.many1=d,t.array=h,t.series=m,t.head=g,t.seq=y,t.between=b,t.sepByN=x,t.sepBy1=v,t.sepBy=function(e,t){return x(0,Number.MAX_VALUE,e,t)},t.endByN=O,t.endBy1=function(e,t){return O(1,Number.MAX_VALUE,e,t)},t.endBy=function(e,t){return O(0,Number.MAX_VALUE,e,t)},t.fmap=k,t.pure=w,t.option=_,t.optional=function(e){return _(e,void 0)},t.skipMany=S,t.skipMany1=q,t.lookAhead=function(e){return new o.Parser((function(t){const n=o.parse(e,t);return n.success?o.ok(t,n.value):n}))},t.notFollowedBy=P,t.lazy=function(e){return new o.Parser((function(t){return o.parse(e(),t)}))},t.label=$,t.satisfy=A,t.until=j,t.Join={many:e=>k(e=>e.join(""),l(e)),many1:e=>k(e=>e.join(""),d(e)),sepBy1:(e,t)=>k(e=>e.join(""),v(e,t)),array:e=>k(e=>e.join(""),h(e)),series:(...e)=>k(e=>e.join(""),m(...e))},t.oneOf=C,t.noneOf=function(e){return A((t,n)=>-1===e.indexOf(t))},t.char=L,t.charCode=function(e){return A((t,n)=>n===e)},t.regexp=function(e){return new o.Parser((function(t){if(t.position<t.source.length){const n=t.source.slice(t.position),r=n.match(e);if(r&&0===r.index&&r.length>0){const s=r[0];return 0===n.indexOf(s)?o.ok(t.seek(s.length),s):o.error(t,()=>"/"+e+"/")}}return o.error(t,()=>""+e)}))},t.range=function(e,t){return"string"==typeof e&&(e=e.charCodeAt(0)),"string"==typeof t&&(t=t.charCodeAt(0)),A((n,r)=>r>=e&&r<=t)},t.string=B,t.anyChar=A(e=>!0),t.space=C("\t\r\n"),t.spaces=k(e=>e.join(),l(t.space)),t.newLine=C("\r\n"),t.tab=L("\t"),t.upper=C("ABCDEFGHIJKLMNOPQRSTUVWXYZ"),t.lower=C("abcdefghijklmnopqrstuvwxyz"),t.alphaNum=C("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"),t.letter=C("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"),t.digit=C("0123456789"),t.octDigit=C("01234567"),t.hexDigit=C("0123456789abcdefghABCDEFGH"),function(e){e[e.AssocNone=0]="AssocNone",e[e.AssocLeft=1]="AssocLeft",e[e.AssocRight=2]="AssocRight"}(t.Assoc||(t.Assoc={}));t.LeftAssoc=class{constructor(e){this.p=e}};t.RightAssoc=class{constructor(e){this.p=e}};t.NoneAssoc=class{constructor(e){this.p=e}};t.Prefix=class{constructor(e){this.p=e}};t.Postfix=class{constructor(e){this.p=e}};t.OperatorTable=class{constructor(e=[],t=[],n=[],r=[],s=[]){this.infixr=e,this.infixl=t,this.infix=n,this.prefix=r,this.postfix=s}},t.buildExpressionParser=function(e,t){return e.reduce((function(e,t){const n=a(t.infixr),r=a(t.infixl),s=a(t.infix),o=a(t.prefix),u=a(t.postfix);function p(e,t){return c(y(n=>(n(t),n(i(`ambiguous use of a ${e} associative operator`)))))}const l=p("right",n),d=p("left",r),h=p("non",s),m=f(u,w(e=>e)),g=f(o,w(e=>e));function b(e){return f(y(t=>{const r=t(n),s=t(y(e=>{const t=e(v);return e(function(e){return f(b(e),w(e))}(t))}));if(t.success)return r(e,s)}),d,h)}function x(e){return f(y(t=>{const n=t(r),s=t(v);if(t.success)return t(function(e){return f(x(e),w(e))}(n(e,s)))}),l,h)}const v=y(t=>{const n=t(g),r=t(e),s=t(m);if(t.success)return s(n(r))});return y(e=>{const t=e(v);if(e.success)return e($("operator",f(b(t),x(t),function(e){return y(t=>{const n=t(s),r=t(v);if(t.success)return t(f(l,d,h,w(n(e,r))))})}(t),w(t))))})}),t)},t.buildTokenParser=function(e){const n=q(C(" \n\t\r")),r=c(e.multiCommentStart),s=c(e.multiCommentEnd),o=$("end of single line comment",y(t=>(t(e.singleCommentLine),t(j(B("\n")))))),i=y(e=>{e(r);const t=e(j(s));return e(s),e(w(t))}),a=S(f(n,k(e=>{},i),k(e=>{},o)));function p(e){return y(t=>{const n=t(e);return t(a),n})}function h(e){return p(B(e))}const m=h(";"),g=h(","),x=h("."),v=h(":"),O=y(n=>n(e.opStart)+n(t.Join.many(e.opLetter))),L=p(c(y(t=>{const n=t(O);return function(t){return e.reservedOps.indexOf(t)>-1}(n)?t(u("reserved operator "+n)):n}))),M=y(n=>{const r=n(e.identifierStart),s=n(t.Join.many(e.identifierLetter));return n.success&&r+s}),N=p(c(y(t=>{const n=t(M);return!n||function(t){const n=e.caseSensitive?e.reservedNames:e.reservedNames.map(e=>e.toLowerCase()),r=e.caseSensitive?t:t.toLowerCase();return n.indexOf(r)>-1}(n)?t(u(n+" is reserved word")):n}))),E=y(e=>{const n=e(t.anyChar);switch(n){case"r":return"\\r";case"n":return"\\n";case"\\":return"\\\\";case'"':return e(u(n));default:return n}}),T=y(e=>(e(B("\\")),e(E)));function D(e){return A((t,n)=>n>=32&&t!==e&&"\\"!==t)}const F=D("'"),R=$("charLiteral",p(b(B("'"),f(F,T),B("'")))),X=D('"'),J=$("stringLiteral",p(k(e=>e.join(""),b(B('"'),l(f(X,T)),B('"')))));function U(e,t){return k(t=>t.reduce((t,n)=>t*e+parseInt(n),0),d(t))}const V=U(10,t.digit),I=y(e=>(e(C("xX")),e(U(16,t.hexDigit)))),z=y(e=>(e(C("oO")),e(U(8,t.octDigit)))),H=y(e=>(e(B("0")),e(f(V,I,z,w(0))))),G=f(H,V),K=f(y(e=>(e(B("-")),e(w(e=>-e)))),y(e=>(e(B("+")),e(w(e=>e)))),w(e=>e)),Q=y(e=>{const t=e(p(K)),n=e(G);return e.success?t(n):void 0}),W=$("exponent",y(e=>{e(C("eE"));const t=e(K),n=e(V);return e.success?function e(t){return t<0?1/e(-t):Math.pow(10,t)}(t(n)):void 0})),Y=$("fraction",y(e=>{e(B("."));const n=e(d(t.digit));return e.success?function(e){return parseFloat("0."+e.reduce((e,t)=>e+t,""))}(n):void 0}));function Z(e){return f(y(t=>{const n=t(Y),r=t(_(W,1));return t.success?(e+n)*r:void 0}),y(t=>{const n=t(W);return t.success?e*n:void 0}))}const ee=y(e=>{const t=e(V);return e(Z(t))}),te=y(e=>{const t=e(V);return e(_(Z(t),t))}),ne=f(f(I,z),te,Z(0),w(0)),re=p(f(y(e=>(e(B("0")),e(ne))),te)),se=p(ee),oe=p(Q);return{identifier:N,reservedOp:function(t){return p(c(y(n=>{const r=n(B(t));return n(P(e.opLetter)),r})))},reserved:function(t){return p(c(y(n=>{const r=n(B(t,e.caseSensitive));return n(P(e.identifierLetter)),r})))},operator:L,charLiteral:R,stringLiteral:J,natural:p(G),integer:oe,float:se,naturalOrFloat:re,decimal:V,hexadecimal:I,octal:z,symbol:h,lexeme:p,whiteSpace:n,whiteSpaceOrComment:a,multiLineComment:i,singleLineComment:o,parens:function(e){return b(h("("),e,h(")"))},braces:function(e){return b(h("{"),e,h("}"))},angles:function(e){return b(h("<"),e,h(">"))},brackets:function(e){return b(h("["),e,h("]"))},semi:m,comma:g,colon:v,dot:x}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this._last="",this._indent=0,this._options=e||{indent:"  "}}indent(){this._indent++}dedent(){this._indent--}_getIndent(){return function(e,t){let n="";if(!e||t<1||t>Number.MAX_SAFE_INTEGER)return n;do{t%2&&(n+=e),(t=Math.floor(t/2))&&(e+=e)}while(t);return n}(this._options.indent,this._indent)}get(e){const t=this._getIndent()+e;return-1===t.indexOf("undefined")&&(this._last=t),t}transaction(){let e=[];return{queue:t=>{e.push(this._getIndent()),e.push(t),-1===t.indexOf("undefined")&&(this._last=t)},append:t=>{e.push(t),-1===t.indexOf("undefined")&&(this._last=t)},get:()=>e.join(""),rollback:()=>{e=[]},indent:()=>this.indent(),dedent:()=>this.dedent()}}}}])}));